# 快速開始指南

## 🚀 立即執行

### 1. 安裝依賴（首次執行）

```bash
npm install
```

### 2. 啟動應用程式

```bash
npm start
```

## 📖 基本使用

### 方式 A: 使用 API 自動獲取登入資訊（推薦）

#### 步驟 1: 輸入銀行編號

在介面中輸入銀行編號（例如：`101` 代表台灣銀行）

**目前支援的銀行編號**：
- `101` - 台灣銀行 ✅

#### 步驟 2: 獲取登入資訊

點擊「獲取登入資訊」按鈕，系統會自動呼叫 API 並顯示：
- 銀行名稱
- 統一編號
- 使用者代號
- 設定檔代號

#### 步驟 3: 設定查詢天數

調整「查詢天數」欄位：
- `0` - 僅查詢當日
- `7` - 查詢最近 7 天
- `30` - 查詢最近 30 天

#### 步驟 4: 開始自動化

點擊「開始執行自動化」按鈕。

---

### 方式 B: 手動輸入登入資訊（API 失敗時）

如果 API 查詢失敗，系統會自動顯示「手動輸入區域」：

#### 步驟 1: 填寫登入資訊

在顯示的表單中填寫：
- **公司統編**：例如 `50660688`
- **使用者帳號**：例如 `locker1688`
- **使用者密碼**：例如 `Aa16881688`

#### 步驟 2: 開始自動化

點擊「使用手動輸入開始自動化」按鈕。

---

### 共同步驟：自動化執行

無論使用哪種方式，系統都會：
1. 開啟銀行登入頁面（獨立 Chrome 瀏覽器視窗）
2. 自動填寫統編、帳號、密碼
3. 等待您手動輸入驗證碼（4 位數）
4. **驗證碼輸入完成後，完全自動執行**：
   - ✅ 自動點擊登入
   - ✅ 等待登入成功
   - ✅ 自動導航到帳務查詢
   - ✅ 自動設定日期範圍
   - ✅ 自動執行查詢
   - ✅ 自動提取交易資料

### 步驟 5: 觀察日誌

在「執行狀態日誌」區域中，您可以看到：
- 系統執行的每一步驟
- 成功/錯誤訊息
- 交易資料提取結果

## 🛠️ 開發相關

### 打包應用程式

```bash
npm run package
```

打包後的檔案會在 `out/` 資料夾中。

### 建立安裝包

```bash
npm run make
```

### 專案結構

```
cz-software/
├── main.js              # 主進程（後端）
├── renderer.js          # 渲染進程（前端邏輯）
├── preload.js           # 安全橋接層
├── index.html           # 使用者介面
├── styles.css           # 樣式
└── src/
    └── banks/           # 銀行模組
        ├── index.js     # 管理器
        ├── utils.js     # 工具函式
        └── bot.js       # 台灣銀行
```

## ⚠️ 注意事項

1. **驗證碼**：目前需要手動輸入，未來會加入 OCR 自動識別
2. **網路**：需要連接網際網路才能呼叫 API
3. **權限**：某些銀行網站可能需要特殊權限設定

## 🐛 常見問題

### Q: 無法獲取銀行資訊？
A: 請檢查：
- 網路連線是否正常
- 銀行編號是否正確
- API 伺服器是否運作中

### Q: 自動化視窗無法開啟？
A: 請確認：
- Electron 是否正確安裝（`npm install`）
- 沒有其他程式佔用視窗資源

### Q: 驗證碼輸入後沒有反應？
A: 可能原因：
- 驗證碼長度不符（台灣銀行為 4 位數）
- 驗證碼錯誤，需要重新輸入

## 📚 延伸閱讀

- [README.md](README.md) - 完整專案說明
- [MIGRATION_SUMMARY.md](MIGRATION_SUMMARY.md) - 移植技術細節

## 💡 小技巧

- 保持日誌視窗可見，隨時掌握執行狀態
- 定期檢查 API 回傳的帳號資訊是否正確
- 如果自動化卡住，可以點擊「停止自動化」後重新開始

---

**祝您使用愉快！** 🎉

