# 使用者介面指南

## 介面總覽

應用程式介面分為以下幾個主要區域：

```
┌────────────────────────────────────────────────────────┐
│  CZ 銀行自動化助手                            [v1.0.0] │
├────────────────────────────────────────────────────────┤
│                                                        │
│  ┌──────────────────────────────────────────────┐    │
│  │ 1. 設定與查詢                                 │    │
│  │                                              │    │
│  │ 銀行編號 (Bank ID)                           │    │
│  │ [101          ] [獲取登入資訊]               │    │
│  │                                              │    │
│  │ 查詢天數 (往前推算)                          │    │
│  │ [0          ]                                │    │
│  │ 0 代表僅查詢當日                             │    │
│  └──────────────────────────────────────────────┘    │
│                                                        │
│  ┌──────────────────────────────────────────────┐    │
│  │ 2. 銀行資訊確認              ← API 成功時顯示 │    │
│  │                                              │    │
│  │ 銀行名稱: 臺灣銀行    統編: 50660688         │    │
│  │ 使用者代號: locker1688  設定檔: bot          │    │
│  │                                              │    │
│  │ [      開始執行自動化      ]                 │    │
│  └──────────────────────────────────────────────┘    │
│                                                        │
│  ┌──────────────────────────────────────────────┐    │
│  │ 手動輸入登入資訊          ← API 失敗時顯示    │    │
│  │                                              │    │
│  │ ⚠️ API 查詢失敗                             │    │
│  │ 請手動輸入登入資訊以繼續                     │    │
│  │                                              │    │
│  │ 銀行代號 (Bank Code)                        │    │
│  │ [bot - 臺灣銀行        ▼]                   │    │
│  │                                              │    │
│  │ 公司統編                                    │    │
│  │ [50660688                        ]          │    │
│  │                                              │    │
│  │ 使用者帳號                                  │    │
│  │ [locker1688                      ]          │    │
│  │                                              │    │
│  │ 使用者密碼                                  │    │
│  │ [••••••••                        ]          │    │
│  │                                              │    │
│  │ [  使用手動輸入開始自動化  ] [取消]          │    │
│  └──────────────────────────────────────────────┘    │
│                                                        │
│  ┌──────────────────────────────────────────────┐    │
│  │ 控制面板                  ← 自動化執行時顯示  │    │
│  │ [        停止自動化        ]  (紅色按鈕)     │    │
│  └──────────────────────────────────────────────┘    │
│                                                        │
│  ┌──────────────────────────────────────────────┐    │
│  │ 執行狀態日誌                         [清除]  │    │
│  │ ╔══════════════════════════════════════════╗ │    │
│  │ ║ [09:30:15] 系統已就緒，請輸入銀行編號    ║ │    │
│  │ ║ [09:30:20] 正在查詢銀行資訊...           ║ │    │
│  │ ║ [09:30:22] 獲取成功: 臺灣銀行            ║ │    │
│  │ ║ [09:30:25] 瀏覽器已啟動                 ║ │    │
│  │ ║ [09:30:28] 已填寫統編: 50660688         ║ │    │
│  │ ║ [09:30:30] 請輸入驗證碼                 ║ │    │
│  │ ║ [09:30:45] 登入成功！                   ║ │    │
│  │ ║ [09:30:50] 步驟 1: 前往帳務查詢...      ║ │    │
│  │ ╚══════════════════════════════════════════╝ │    │
│  └──────────────────────────────────────────────┘    │
└────────────────────────────────────────────────────────┘
```

## 介面元素詳細說明

### 1. 設定與查詢區域

#### 銀行編號輸入框
- **用途**：輸入銀行的數字編號
- **範例值**：`101`（台灣銀行）
- **驗證**：必須為數字
- **鎖定時機**：自動化執行時

#### 獲取登入資訊按鈕
- **狀態 1**：`獲取登入資訊`（可點擊）
- **狀態 2**：`查詢中...`（載入中）
- **狀態 3**：禁用（自動化執行時）

#### 查詢天數輸入框
- **用途**：設定往前推算幾天的交易紀錄
- **範圍**：0-90 天
- **預設值**：`0`（僅查詢當日）
- **鎖定時機**：自動化執行時

---

### 2. 銀行資訊確認區域（API 模式）

**顯示條件**：API 成功獲取資料時顯示

#### 資訊網格
- **銀行名稱**：例如「臺灣銀行」
- **統編**：8 位數字，例如「50660688」
- **使用者代號**：登入帳號，例如「locker1688」
- **設定檔**：銀行代號，例如「bot」

#### 開始執行自動化按鈕
- **樣式**：綠色、大按鈕
- **功能**：啟動 Puppeteer 自動化流程

---

### 3. 手動輸入區域（備援模式）

**顯示條件**：API 查詢失敗時自動顯示

#### 警告訊息
```
⚠️ API 查詢失敗
請手動輸入登入資訊以繼續
```

#### 銀行代號下拉選單（新增）
- **用途**：選擇要使用的銀行配置
- **選項**：
  - `bot` - 臺灣銀行 ✅（已移植）
  - `hncb` - 華南商銀（尚未移植）
  - `yuanta` - 元大銀行（尚未移植）
  - ... 其他銀行
- **預設值**：`bot`
- **重要**：必須選擇已移植的銀行代號

#### 公司統編輸入框
- **用途**：輸入公司的統一編號
- **範例**：`50660688`
- **格式**：8 位數字

#### 使用者帳號輸入框
- **用途**：輸入銀行使用者代號
- **範例**：`locker1688`
- **格式**：依各銀行規定

#### 使用者密碼輸入框
- **用途**：輸入登入密碼
- **類型**：`password`（隱藏顯示）
- **範例**：`Aa16881688`

#### 使用手動輸入開始自動化按鈕
- **樣式**：綠色、大按鈕
- **功能**：使用手動輸入的資料啟動自動化
- **驗證**：必須填寫完整（銀行代號 + 統編 + 帳號 + 密碼）

#### 取消按鈕
- **樣式**：文字按鈕（灰色）
- **功能**：隱藏手動輸入面板，清空已填寫的資料

---

### 4. 控制面板

#### 停止自動化按鈕
- **顯示條件**：自動化執行時顯示
- **樣式**：紅色、大按鈕
- **功能**：立即停止自動化並關閉 Puppeteer 瀏覽器

---

### 5. 執行狀態日誌區域

#### 日誌容器
- **高度**：200px（固定）
- **滾動**：自動滾動到最新訊息
- **樣式**：黑色背景，等寬字體（類似終端機）

#### 日誌類型

| 類型 | 顏色 | 範例 |
|-----|------|------|
| `system` | 🟡 黃色 | `系統已就緒` |
| `info` | ⚪ 白色 | `正在查詢銀行資訊...` |
| `success` | 🟢 綠色 | `獲取成功: 臺灣銀行` |
| `error` | 🔴 紅色 | `獲取失敗: 連線逾時` |

#### 清除按鈕
- **位置**：日誌區域右上角
- **功能**：清空所有日誌訊息

## 互動流程

### 流程 1: 正常使用（API 成功）

```
[初始畫面]
  ↓ 使用者輸入 101
  ↓ 點擊「獲取登入資訊」
  
[載入狀態]
  按鈕變更為「查詢中...」
  日誌顯示：正在查詢銀行資訊...
  
  ↓ API 回傳成功
  
[顯示銀行資訊]
  隱藏：手動輸入面板
  顯示：銀行資訊確認面板
  日誌顯示：獲取成功: 臺灣銀行
  
  ↓ 使用者點擊「開始執行自動化」
  
[自動化執行中]
  鎖定：銀行編號、查詢天數、獲取按鈕
  隱藏：開始按鈕
  顯示：停止按鈕
  開啟：Puppeteer 瀏覽器視窗
  日誌持續更新：步驟進度
```

### 流程 2: API 失敗使用手動輸入

```
[初始畫面]
  ↓ 使用者輸入 999（不存在）
  ↓ 點擊「獲取登入資訊」
  
[載入狀態]
  按鈕變更為「查詢中...」
  日誌顯示：正在查詢銀行資訊...
  
  ↓ API 回傳失敗
  
[顯示手動輸入面板]
  隱藏：銀行資訊確認面板
  顯示：手動輸入面板（黃色邊框）
  日誌顯示：
    - 獲取失敗: 不支援的銀行
    - 您可以選擇手動輸入登入資訊
  
  ↓ 使用者填寫：
     - 銀行代號: bot
     - 統編: 50660688
     - 帳號: locker1688
     - 密碼: Aa16881688
  ↓ 點擊「使用手動輸入開始自動化」
  
[自動化執行中]
  隱藏：手動輸入面板
  鎖定：所有輸入欄位
  顯示：停止按鈕
  日誌顯示：使用手動輸入資料開始自動化...
  開啟：Puppeteer 瀏覽器視窗
```

### 流程 3: 取消手動輸入

```
[顯示手動輸入面板]
  使用者已填寫部分資料
  
  ↓ 點擊「取消」按鈕
  
[回到初始狀態]
  隱藏：手動輸入面板
  清空：所有手動輸入欄位
  解鎖：銀行編號輸入框
  日誌顯示：已取消手動輸入
  
  ↓ 使用者可重新嘗試「獲取登入資訊」
```

## 手動輸入面板詳細說明

### 銀行代號下拉選單

```html
<select id="manual-bank-code">
  <option value="bot">bot - 臺灣銀行</option>          ✅ 已支援
  <option value="yuanta">yuanta - 元大銀行 (尚未移植)</option>
  <option value="hncb">hncb - 華南商銀 (尚未移植)</option>
  <!-- ... 其他銀行 -->
</select>
```

**重要提示**：
- 選擇「尚未移植」的銀行會導致自動化失敗
- 系統會在主進程中檢查銀行是否支援
- 目前僅 `bot`（台灣銀行）完全可用

### 表單驗證

當使用者點擊「使用手動輸入開始自動化」時，系統會驗證：

```javascript
// 驗證 1: 銀行代號不能為空
if (!bankCode) {
    顯示錯誤：「請選擇銀行代號」
    return;
}

// 驗證 2: 登入資訊必須完整
if (!companyId || !userId || !password) {
    顯示錯誤：「請填寫完整的登入資訊（統編、帳號、密碼）」
    return;
}

// 驗證通過 → 開始自動化
```

## 樣式說明

### 顏色系統

```css
--primary-color: #007bff;    /* 藍色 - 主要按鈕 */
--success-color: #28a745;    /* 綠色 - 開始自動化 */
--danger-color: #dc3545;     /* 紅色 - 停止自動化 */
--warning-color: #ffc107;    /* 黃色 - 警告提示 */
```

### 按鈕樣式

| 按鈕類型 | 樣式類別 | 顏色 | 用途 |
|---------|---------|------|------|
| 獲取登入資訊 | `btn primary` | 藍色 | 主要操作 |
| 開始執行自動化 | `btn success large` | 綠色 | 確認操作 |
| 停止自動化 | `btn danger large` | 紅色 | 危險操作 |
| 取消 | `btn text` | 灰色 | 次要操作 |

### 狀態指示

#### 輸入框狀態
```css
/* 正常狀態 */
input { border: 1px solid #dee2e6; }

/* 聚焦狀態 */
input:focus { border-color: #007bff; }

/* 禁用狀態 */
input:disabled { 
    background-color: #f5f5f5; 
    cursor: not-allowed; 
}
```

#### 面板邊框
```css
/* 普通面板 */
.card { border: 1px solid #dee2e6; }

/* 手動輸入面板（警告狀態） */
.manual-panel { border: 2px solid #ffc107; }
```

## 響應式設計

目前介面為固定寬度（最大 800px），適合桌面應用程式使用。

```css
.container {
    max-width: 800px;
    margin: 0 auto;
}
```

## 鍵盤快捷鍵（未來擴充）

可考慮加入以下快捷鍵：

| 快捷鍵 | 功能 |
|-------|------|
| `Ctrl/Cmd + Enter` | 開始自動化 |
| `Esc` | 停止自動化 |
| `Ctrl/Cmd + L` | 清除日誌 |

## 無障礙設計（未來擴充）

目前可改進的地方：
- [ ] 加入 ARIA 標籤
- [ ] 鍵盤導航支援
- [ ] 螢幕閱讀器支援
- [ ] 高對比度模式

---

**介面版本**: v1.1  
**最後更新**: 2025-12-03  
**新增功能**: 手動輸入 - 銀行代號選擇器

